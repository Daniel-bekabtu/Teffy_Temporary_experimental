<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Farm Registration - Teffy Africa</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
      }

      :root {
        --primary-green: #1a8d5f;
        --light-green: rgba(26, 141, 95, 0.1);
        --dark-green: #147a4f;
        --white: #ffffff;
        --glass-bg: rgba(255, 255, 255, 0.85);
        --error-red: #ff4444;
        --success-green: #00c851;
        --warning-yellow: #ffbb33;
        --section-gap: 2rem;
      }

      body {
        min-height: 100vh;
        background: #ffffff;
        color: #333;
        line-height: 1.6;
      }

      #particles-js {
        position: fixed;
        width: 100%;
        height: 100%;
        z-index: -1;
      }

      .container {
        max-width: 1200px;
        margin: 2rem auto;
        padding: 0 2rem;
      }

      .progress-bar {
        position: sticky;
        top: 0;
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        padding: 1rem;
        border-radius: 12px;
        margin-bottom: 2rem;
        z-index: 100;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .progress-steps {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 800px;
        margin: 0 auto;
      }

      .step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        flex: 1;
      }

      .step::before {
        content: "";
        position: absolute;
        width: 100%;
        height: 3px;
        background: var(--light-green);
        top: 15px;
        left: 50%;
        transform: translateY(-50%);
        z-index: -1;
      }

      .step:last-child::before {
        display: none;
      }

      .step-number {
        width: 30px;
        height: 30px;
        background: var(--light-green);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 600;
        color: var(--primary-green);
        margin-bottom: 0.5rem;
        transition: all 0.3s ease;
      }

      .step.active .step-number {
        background: var(--primary-green);
        color: white;
      }

      .step-label {
        font-size: 0.85rem;
        color: #666;
        text-align: center;
      }

      .form-card {
        background: var(--glass-bg);
        backdrop-filter: blur(10px);
        border-radius: 24px;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
        margin-bottom: var(--section-gap);
      }

      .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--light-green);
      }

      .section-title {
        color: var(--primary-green);
        font-size: 1.5rem;
        font-weight: 600;
      }

      .section-subtitle {
        color: #666;
        font-size: 0.9rem;
        margin-top: 0.5rem;
      }

      .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        color: #333;
        margin-bottom: 0.5rem;
        font-size: 0.9rem;
        font-weight: 500;
      }

      .form-input {
        width: 100%;
        padding: 0.8rem;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.9);
        font-size: 0.9rem;
        transition: all 0.3s ease;
      }

      .form-input:focus {
        outline: none;
        border-color: var(--primary-green);
        box-shadow: 0 0 0 3px var(--light-green);
      }

      .currency-input-group {
        position: relative;
        display: flex;
        align-items: center;
      }

      .currency-symbol {
        position: absolute;
        left: 1rem;
        color: #666;
        font-weight: 500;
      }

      .currency-input {
        padding-left: 2.5rem;
      }

      .file-upload {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 2rem;
        border: 2px dashed rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .file-upload:hover {
        border-color: var(--primary-green);
        background: var(--light-green);
      }

      .file-upload input[type="file"] {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        opacity: 0;
        cursor: pointer;
      }

      .file-upload-icon {
        width: 40px;
        height: 40px;
        color: var(--primary-green);
        margin-bottom: 1rem;
      }

      .file-upload-text {
        color: #666;
        font-size: 0.9rem;
        text-align: center;
      }

      .image-preview {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
        gap: 1rem;
        margin-top: 1rem;
      }

      .image-preview img {
        width: 100%;
        height: 100px;
        object-fit: cover;
        border-radius: 8px;
      }

      .form-footer {
        display: flex;
        justify-content: space-between;
        margin-top: 2rem;
        padding-top: 2rem;
        border-top: 1px solid var(--light-green);
      }

      .btn {
        padding: 0.8rem 1.5rem;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s ease;
        border: none;
      }

      .btn-primary {
        background: var(--primary-green);
        color: white;
      }

      .btn-primary:hover {
        background: var(--dark-green);
        transform: translateY(-2px);
      }

      .btn-secondary {
        background: var(--light-green);
        color: var(--primary-green);
      }

      .btn-secondary:hover {
        background: rgba(26, 141, 95, 0.2);
      }

      @media (max-width: 768px) {
        .container {
          padding: 1rem;
        }

        .form-card {
          padding: 1.5rem;
        }

        .progress-steps {
          overflow-x: auto;
          padding-bottom: 1rem;
        }

        .step {
          min-width: 120px;
        }
      }
    </style>
  </head>
  <body>
    <div id="particles-js"></div>
    <div class="container">
      <div class="progress-bar">
        <div class="progress-steps">
          <div class="step active">
            <div class="step-number">1</div>
            <div class="step-label">Basic Info</div>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <div class="step-label">Location</div>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <div class="step-label">Farm Details</div>
          </div>
          <div class="step">
            <div class="step-number">4</div>
            <div class="step-label">Documents</div>
          </div>
          <div class="step">
            <div class="step-number">5</div>
            <div class="step-label">Financials</div>
          </div>
        </div>
      </div>

      <form
        id="farmRegistrationForm"
        method="POST"
        action="/register_farm"
        enctype="multipart/form-data"
      >
        <!-- Basic Information Section -->
        <div class="form-card" id="section1">
          <div class="section-header">
            <div>
              <h2 class="section-title">Basic Information</h2>
              <p class="section-subtitle">
                Enter the basic details about your farm
              </p>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="farmName">Farm Name</label>
              <input
                type="text"
                id="farmName"
                name="farmName"
                class="form-input"
                required
                placeholder="Enter farm name"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="ownerName">Owner Name</label>
              <input
                type="text"
                id="ownerName"
                name="ownerName"
                class="form-input"
                required
                placeholder="Enter owner's name"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="contactPhone">Contact Phone</label>
              <input
                type="tel"
                id="contactPhone"
                name="contactPhone"
                class="form-input"
                required
                placeholder="Enter contact number"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="contactEmail">Contact Email</label>
              <input
                type="email"
                id="contactEmail"
                name="contactEmail"
                class="form-input"
                required
                placeholder="Enter contact email"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="nationality">Nationality</label>
              <input
                type="text"
                id="nationality"
                name="nationality"
                class="form-input"
                required
                placeholder="Enter nationality"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="region">Region</label>
              <input
                type="text"
                id="region"
                name="region"
                class="form-input"
                required
                placeholder="Enter region"
              />
            </div>
          </div>
        </div>

        <!-- Location Section -->
        <div class="form-card" id="section2">
          <div class="section-header">
            <div>
              <h2 class="section-title">Location Details</h2>
              <p class="section-subtitle">
                Provide the exact location of your farm
              </p>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="farmAddress">Farm Address</label>
              <input
                type="text"
                id="farmAddress"
                name="farmAddress"
                class="form-input"
                required
                placeholder="Enter complete farm address"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="latitude">Latitude</label>
              <input
                type="text"
                id="latitude"
                name="latitude"
                class="form-input"
                required
                placeholder="Enter latitude coordinates"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="longitude">Longitude</label>
              <input
                type="text"
                id="longitude"
                name="longitude"
                class="form-input"
                required
                placeholder="Enter longitude coordinates"
              />
            </div>

            <div class="form-group">  
              <label class="form-label" for="elevation"
                >Elevation (meters)</label
              >
              <input
                type="number"
                id="elevation"
                name="elevation"
                class="form-input"
                required
                placeholder="Enter elevation"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="totalArea"
                >Total Area (hectares)</label
              >
              <input
                type="number"
                id="totalArea"
                name="totalArea"
                class="form-input"
                required
                placeholder="Enter total area"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="accessRoads">Access Roads</label>
              <input
                type="text"
                id="accessRoads"
                name="accessRoads"
                class="form-input"
                required
                placeholder="Describe access roads"
              />
            </div>
          </div>
        </div>

        <!-- Farm Details Section -->
        <div class="form-card" id="section3">
          <div class="section-header">
            <div>
              <h2 class="section-title">Farm Details</h2>
              <p class="section-subtitle">
                Tell us more about your farming operations
              </p>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="farmType">Farm Type</label>
              <select id="farmType" name="farmType" class="form-input" required>
                <option value="">Select farm type</option>
                <option value="crop">Crop Farming</option>
                <option value="livestock">Livestock Farming</option>
                <option value="mixed">Mixed Farming</option>
                <option value="poultry">Poultry Farming</option>
                <option value="aquaculture">Aquaculture</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="mainCrops"
                >Main Crops/Livestock</label
              >
              <input
                type="text"
                id="mainCrops"
                name="mainCrops"
                class="form-input"
                required
                placeholder="Enter main crops or livestock"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="farmingPractice"
                >Farming Practice</label
              >
              <select
                id="farmingPractice"
                name="farmingPractice"
                class="form-input"
                required
              >
                <option value="">Select farming practice</option>
                <option value="conventional">Conventional</option>
                <option value="organic">Organic</option>
                <option value="sustainable">Sustainable</option>
                <option value="integrated">Integrated</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="waterSource">Water Source</label>
              <select
                id="waterSource"
                name="waterSource"
                class="form-input"
                required
              >
                <option value="">Select water source</option>
                <option value="river">River</option>
                <option value="well">Well</option>
                <option value="rainwater">Rainwater</option>
                <option value="municipal">Municipal Supply</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="soilType">Soil Type</label>
              <select id="soilType" name="soilType" class="form-input" required>
                <option value="">Select soil type</option>
                <option value="sandy">Sandy</option>
                <option value="clay">Clay</option>
                <option value="loamy">Loamy</option>
                <option value="silt">Silt</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="infrastructure"
                >Available Infrastructure</label
              >
              <input
                type="text"
                id="infrastructure"
                name="infrastructure"
                class="form-input"
                required
                placeholder="List available infrastructure"
              />
            </div>
          </div>
        </div>

        <!-- Documents Section -->
        <div class="form-card" id="section4">
          <div class="section-header">
            <div>
              <h2 class="section-title">Documents & Certifications</h2>
              <p class="section-subtitle">
                Upload required documents and certifications
              </p>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Land Title Certificate</label>
            <div class="file-upload">
              <svg class="file-upload-icon" viewBox="0 0 24 24">
                <path
                  d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <polyline
                  points="17 8 12 3 7 8"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <line
                  x1="12"
                  y1="3"
                  x2="12"
                  y2="15"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              <p class="file-upload-text">
                Click to upload or drag and drop<br />PDF or image file
              </p>
              <input
                type="file"
                name="landTitle"
                accept=".pdf,image/*"
                required
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Farm Images</label>
            <div class="file-upload">
              <svg class="file-upload-icon" viewBox="0 0 24 24">
                <rect
                  x="3"
                  y="3"
                  width="18"
                  height="18"
                  rx="2"
                  ry="2"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <circle
                  cx="8.5"
                  cy="8.5"
                  r="1.5"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <polyline
                  points="21 15 16 10 5 21"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              <p class="file-upload-text">
                Upload multiple images of your farm<br />Maximum 5 images
              </p>
              <input
                type="file"
                name="farmImages"
                accept="image/*"
                multiple
                required
              />
            </div>
            <div class="image-preview" id="imagePreview"></div>
          </div>

          <div class="form-group">
            <label class="form-label">Additional Certifications</label>
            <div class="file-upload">
              <svg class="file-upload-icon" viewBox="0 0 24 24">
                <path
                  d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <polyline
                  points="17 8 12 3 7 8"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                />
                <line
                  x1="12"
                  y1="3"
                  x2="12"
                  y2="15"
                  stroke="currentColor"
                  stroke-width="2"
                />
              </svg>
              <p class="file-upload-text">
                Upload any additional certifications<br />PDF or image files
              </p>
              <input
                type="file"
                name="certifications"
                accept=".pdf,image/*"
                multiple
              />
            </div>
          </div>
        </div>

        <!-- Financial Section -->
        <div class="form-card" id="section5">
          <div class="section-header">
            <div>
              <h2 class="section-title">Financial Information</h2>
              <p class="section-subtitle">
                Provide details about funding requirements
              </p>
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label" for="fundAmount"
                >Required Funding Amount</label
              >
              <div class="currency-input-group">
                <span class="currency-symbol">$</span>
                <input
                  type="text"
                  id="fundAmount"
                  name="fundAmount"
                  class="form-input currency-input"
                  required
                  placeholder="Enter amount"
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="fundingPurpose"
                >Purpose of Funding</label
              >
              <select
                id="fundingPurpose"
                name="fundingPurpose"
                class="form-input"
                required
              >
                <option value="">Select purpose</option>
                <option value="expansion">Farm Expansion</option>
                <option value="equipment">Equipment Purchase</option>
                <option value="infrastructure">
                  Infrastructure Development
                </option>
                <option value="working_capital">Working Capital</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label" for="returnRate"
                >Expected Return Rate (%)</label
              >
              <input
                type="number"
                id="returnRate"
                name="returnRate"
                class="form-input"
                required
                placeholder="Enter expected ROI"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="paybackPeriod"
                >Payback Period (months)</label
              >
              <input
                type="number"
                id="paybackPeriod"
                name="paybackPeriod"
                class="form-input"
                required
                placeholder="Enter payback period"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="collateral"
                >Available Collateral</label
              >
              <input
                type="text"
                id="collateral"
                name="collateral"
                class="form-input"
                required
                placeholder="Describe available collateral"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="currentRevenue"
                >Current Annual Revenue</label
              >
              <div class="currency-input-group">
                <span class="currency-symbol">$</span>
                <input
                  type="text"
                  id="currentRevenue"
                  name="currentRevenue"
                  class="form-input currency-input"
                  required
                  placeholder="Enter current revenue"
                />
              </div>
            </div>
          </div>
        </div>

        <div class="form-footer">
          <button type="button" class="btn btn-secondary" id="prevBtn">
            Previous
          </button>
          <button type="button" class="btn btn-primary" id="nextBtn">
            Next
          </button>
          <button
            type="submit"
            class="btn btn-primary"
            id="submitBtn"
            style="display: none"
          >
            Submit Registration
          </button>
        </div>
      </form>
    </div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
      // Particles.js Configuration
      particlesJS("particles-js", {
        particles: {
          number: { value: 30, density: { enable: true, value_area: 800 } },
          color: { value: "#1a8d5f" },
          shape: { type: "circle" },
          opacity: { value: 0.1, random: true },
          size: { value: 3, random: true },
          line_linked: { enable: false },
          move: {
            enable: true,
            speed: 1,
            direction: "bottom",
            random: true,
            straight: false,
            out_mode: "out",
          },
        },
        interactivity: { detect_on: "canvas", events: { resize: true } },
        retina_detect: true,
      });

      // Form Navigation
      let currentSection = 1;
      const totalSections = 5;
      const form = document.getElementById("farmRegistrationForm");
      const nextBtn = document.getElementById("nextBtn");
      const prevBtn = document.getElementById("prevBtn");
      const submitBtn = document.getElementById("submitBtn");

      function showSection(sectionNumber) {
        document.querySelectorAll(".form-card").forEach((section) => {
          section.style.display = "none";
        });
        document.getElementById(`section${sectionNumber}`).style.display =
          "block";
        document.querySelectorAll(".step").forEach((step, index) => {
          if (index + 1 <= sectionNumber) {
            step.classList.add("active");
          } else {
            step.classList.remove("active");
          }
        });
        prevBtn.style.display = sectionNumber === 1 ? "none" : "block";
        nextBtn.style.display =
          sectionNumber === totalSections ? "none" : "block";
        submitBtn.style.display =
          sectionNumber === totalSections ? "block" : "none";
      }
      nextBtn.addEventListener("click", () => {
        if (currentSection < totalSections) {
          currentSection++;
          showSection(currentSection);
        }
      });

      prevBtn.addEventListener("click", () => {
        if (currentSection > 1) {
          currentSection--;
          showSection(currentSection);
        }
      });

      function formatCurrency(input) {
        let value = input.value.replace(/[^\d.]/g, "");
        value = parseFloat(value).toFixed(2);
        if (!isNaN(value)) {
          input.value = value;
        }
      }

      document.querySelectorAll(".currency-input").forEach((input) => {
        input.addEventListener("blur", () => formatCurrency(input));
      });
      document
        .querySelector('input[name="farmImages"]')
        .addEventListener("change", function (e) {
          const preview = document.getElementById("imagePreview");
          preview.innerHTML = "";

          [...e.target.files].forEach((file) => {
            if (file.type.startsWith("image/")) {
              const reader = new FileReader();
              reader.onload = function (e) {
                const img = document.createElement("img");
                img.src = e.target.result;
                preview.appendChild(img);
              };
              reader.readAsDataURL(file);
            }
          });
        });
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const formData = new FormData(form);

        try {
          const response = await fetch("/register_farm_land", {
            method: "POST",
            body: formData,
          });

          if (response.ok) {
            alert("Farm registration successful!");
            window.location.href = "/farmer-dashboard"; 
          } else {
            throw new Error("Registration failed");
          }
        } catch (error) {
          alert("Error submitting form: " + error.message);
        }
      });
      showSection(1);
    </script>
  </body>
</html>
